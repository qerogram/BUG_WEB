# CVE-2022-0440
[![License](https://img.shields.io/badge/license-MIT-brightgreen.svg)](https://opensource.org/licenses/MIT)
<br>

## Author
Qerogram<br><br>

## Version
![version](https://img.shields.io/badge/php-7.4.21-blue)&nbsp; ![version](https://img.shields.io/badge/Catch%20Themes%20Demo%20Import-2.0-green)<br><br>

## Vulnerability
RCE (Remote Code Execution) via File Upload<br><br>
![image](./report_img/image1.png)
<br><br>

## Vector
|Method|Path|
|------|---|
|URI|wp-admin -> Theme -> Catch Themes Demo Import ->Import Demo Data<br>/wp-admin/admin-ajax.php - parameter : redux_file|
|Local Path|/wp-content/plugins/catch-themes-demo-import/inc/Helpers.php – process_uploaded_files()|


![image](./report_img/image2.png)


<br><br>

## How To Trigger Vulnerability
When button called “Import Demo Data” was clicked, function "/wp-content/plugins/catch-th emes-demo-import/inc/CatchThemesDemoImport.php" - import_demo_data_ajax_callback() is called. This function filters extensions to the "widget_file", "customizer_file", and "content_file" files. And then call process_upload_file()(/wp-content/plugins/catch-themes-demo-import/inc/Helpers.php).<br>

![image](./report_img/image3.png)

<br>

Process_upload_files() uploads the three files filtered above and "redux_file" through wp_handle_upload(), where there is no extension filtering for redux_file, so you can upload the desired file. Accordingly, it is possible to trigger an RCE vulnerability by uploading a web shell.

![image](./report_img/image4.png)

<br>
As a result, we get a execute command permission to server. After expoit is successful, it may not work if you attempt exploit again due to an error with redux_plugin. The PoC below solved the problem by initializing redux_file and operating the exploit again.
<br>

![image](./report_img/image1.png)


<br>

<br><br>
# Reference
[1] [Vendor](https://wordpress.org/plugins/catch-themes-demo-import/)
