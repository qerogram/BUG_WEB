# CVE-2022-0420

## Author
Qerogram<br><br>

## Version
![version](https://img.shields.io/badge/php-7.2.24-blue)&nbsp; ![version](https://img.shields.io/badge/RegistrationMagic-5.0.2.1-green)<br><br>

## Vulnerability
SQL Injection<br><br>
![image](./report_img/image5.png)
<br><br>

## Vector
|Method|Path|
|------|---|
|URI|/wp-admin/admin.php?page=rm_ex_chronos_manage_tasks|
|Local Path|/wp-content/plugins/custom-registration-form-builder-with-submission- manager/plus/chronos/libs/rm_chronos.php – get_tasks()|

![image](./report_img/image2.png)

<br><br>

## How To Trigger Vulnerability
When the corresponding request is transmitted, manage_tasks() of the "task_controller.php" file is called. In management_task(), get_tasks() is called by including the value of "rm_form _id" input by the user as a factor.(line 35 ~ 36)
![image](./report_img/image3.png)

<br>
In the 196 line of get_tasks(), a conditional clause in the form of `form_id`=[Payload] is created. When a value called “sleep(1)” is input as a payload, it is ported in the form of `form_id`=sleep(1). Finally generates and executes the Query(Line 202).

```SELECT * FROM wp_rm_tasks WHERE `form_id` = sleep(1) ORDER BY `form_id`, `task_order`, `task_id```
![image](./report_img/image4.png)

<br>

As a result, a delay of 2 seconds occurred when a response came from the server, indicating that the “Time-based Blind SQLi” attack was successful.
![image](./report_img/image1.png)


<br>

<br><br>
# Reference
[1] [Vendor](https://registrationmagic.com/)
